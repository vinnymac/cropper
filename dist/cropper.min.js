/*!
 * Cropper v0.10.0
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2015 Fengyuan Chen and other contributors
 * Released under the MIT license
 *
 * Date: 2015-06-30T03:34:52.220Z
 */
!function(a,b){var c=a.Cropper;b.noConflict=function(){return a.Cropper=c,this},"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.Cropper=b()}(this,function(){"use strict";function a(a){return"number"==typeof a&&!isNaN(a)}function b(a){return"undefined"==typeof a}function c(b,c){var d=[];return a(c)&&d.push(c),d.slice.apply(b,d)}function d(a){var b=typeof a,c="function"===b||"object"===b&&!!a;return c&&a.constructor===Object}function e(a){return"function"==typeof a||!1}function f(a,b){var d=c(arguments,2);return function(){return a.apply(b,d.concat(c(arguments)))}}function g(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==y.protocol||b[2]!==y.hostname||b[3]!==y.port)}function h(a){var b="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+b}function i(a){return a?"rotate("+a+"deg)":"none"}function j(a,b){var c,d,e=ra(a.degree)%180,f=(e>90?180-e:e)*Math.PI/180,g=sa(f),h=ta(f),i=a.width,j=a.height,k=a.aspectRatio;return b?(c=i/(h+g/k),d=c/k):(c=i*h+j*g,d=i*g+j*h),{width:c,height:d}}function k(a,b){var c=document.createElement("canvas"),d=c.getContext("2d"),e=b.naturalWidth,f=b.naturalHeight,g=b.rotate,h=j({width:e,height:f,degree:g});return g?(c.width=h.width,c.height=h.height,d.save(),d.translate(h.width/2,h.height/2),d.rotate(g*Math.PI/180),d.drawImage(a,-e/2,-f/2,e,f),d.restore()):(c.width=e,c.height=f,d.drawImage(a,0,0,e,f)),c}function l(a,b){var c;return window.CustomEvent?c=new CustomEvent(a,{detail:b}):(c=document.createEvent("CustomEvent"),c.initCustomEvent(a,!0,!0,b)),c}function m(a,b,c){a.addEventListener(b,c)}function n(a,b,c){m(a,b,function d(a){a.target.removeEventListener(a.type,d),c&&c(a)})}function o(a,b,c){a.removeEventListener(b,c)}function p(a){if(null===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function q(a,b){if(Object.assign)return Object.assign(a,b);for(var c,d,e=p(a),f=1;f<arguments.length;f++){c=arguments[f],d=Object.keys(Object(c));for(var g=0;g<d.length;g++)e[d[g]]=c[d[g]]}return e}function r(a){a.parentNode&&a.parentNode.removeChild(a)}function s(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)}function t(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function u(a,b,c){if(a.classList)"undefined"===c||null===c?a.classList.toggle(b):c?a.classList.add(b):a.classList.remove(b);else{var d=a.className.split(" "),e=d.indexOf(b);"undefined"===c||null===c?e>=0?d.splice(e,1):d.push(b):c?d.push(b):d.splice(e,1),a.className=d.join(" ")}}function v(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function w(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function x(a,b){this.$element=a,this.options=q({},x.DEFAULTS,d(b)&&b),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.canvas=null,this.cropBox=null,this.load()}var y=window.location,z=".cropper",A="preview"+z,B=A+"-width",C=A+"-height",D=A+"-original",E=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,F="cropper-modal",G="cropper-hide",H="cropper-hidden",I="cropper-invisible",J="cropper-move",K="cropper-crop",L="cropper-disabled",M="cropper-bg",N="mousedown",O="touchstart",P="pointerdown",Q="MSPointerDown",R="mousemove",S="touchmove",T="pointermove",U="MSPointerMove",V="mouseup",W="touchend",X="touchcancel",Y="pointerup",Z="pointercancel",$="MSPointerUp",_="MSPointerCancel",aa="wheel",ba="mousewheel",ca="DOMMouseScroll",da="dblclick",ea="resize",fa="build"+z,ga="built"+z,ha="dragstart"+z,ia="dragmove"+z,ja="dragend"+z,ka="zoomin"+z,la="zoomout"+z,ma="change"+z,na="function"==typeof document.createElement("canvas").getContext||!1,oa=Math.sqrt,pa=Math.min,qa=Math.max,ra=Math.abs,sa=Math.sin,ta=Math.cos,ua=parseFloat,va={};return va.load=function(a){var b,c,d,e,i=this.options,j=this.$element;if(!a)if(j instanceof HTMLImageElement){if(!j.getAttribute("src"))return;a=j.src}else j instanceof HTMLCanvasElement&&na&&(a=j.toDataURL());a&&(d=l(fa),n(j,fa,i.build),j.dispatchEvent(d),d.defaultPrevented||(i.checkImageOrigin&&g(a)&&(b="anonymous",j.crossOrigin||(c=h(a))),this.$clone=e=document.createElement("img"),n(e,"load",f(function(){var b=e.naturalWidth||e.width,c=e.naturalHeight||e.height;this.image={naturalWidth:b,naturalHeight:c,aspectRatio:b/c,rotate:0},this.url=a,this.ready=!0,this.build()},this)),n(e,"error",function(){r(e)}),e.crossOrigin=b||null,e.src=c||a,v(e,G),s(j,e)))},va.build=function(){var a,b,d,e,f=this.$element,g=this.$clone,h=this.options;this.ready&&(this.built&&this.unbuild(),a=document.createElement("div"),a.innerHTML=x.TEMPLATE,this.$cropper=b=a.firstChild,v(f,H),w(g,G),this.$container=f.parentNode,this.$container.appendChild(b),this.$canvas=b.querySelector(".cropper-canvas"),this.$canvas.appendChild(g),this.$dragBox=b.querySelector(".cropper-drag-box"),this.$cropBox=d=b.querySelector(".cropper-crop-box"),this.$viewBox=b.querySelector(".cropper-view-box"),this.$face=e=d.querySelector(".cropper-face"),this.addListeners(),this.initPreview(),h.aspectRatio=ua(h.aspectRatio)||NaN,h.autoCrop?(this.cropped=!0,h.modal&&v(this.$dragBox,F)):v(d,H),h.background&&v(b,M),h.highlight||v(e,I),h.guides||c(d.querySelectorAll(".cropper-dashed")).forEach(function(a){v(a,H)}),h.cropBoxMovable&&(v(e,J),e.setAttribute("data-drag","all")),h.cropBoxResizable||c(d.querySelectorAll(".cropper-line, .cropper-point")).forEach(function(a){v(a,H)}),this.setDragMode(h.dragCrop?"crop":h.movable?"move":"none"),this.built=!0,this.render(),this.setData(h.data),n(f,ga,h.built),f.dispatchEvent(l(ga)))},va.unbuild=function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.removeListeners(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,r(this.$cropper),this.$cropper=null)},q(va,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.$element,b=this.$container,c=this.$cropper,d=this.options;v(c,H),w(a,H),this.container={width:qa(b.offsetWidth,ua(d.minContainerWidth)||200),height:qa(b.offsetHeight,ua(d.minContainerHeight)||100)},q(c.style,{width:this.container.width+"px",height:this.container.height+"px"}),v(a,H),w(c,H)},initCanvas:function(){var a=this.container,b=a.width,c=a.height,d=this.image,e=d.aspectRatio,f={aspectRatio:e,width:b,height:c};c*e>b?f.height=b/e:f.width=c*e,f.oldLeft=f.left=(b-f.width)/2,f.oldTop=f.top=(c-f.height)/2,this.canvas=f,this.limitCanvas(!0,!0),this.initialImage=q({},d),this.initialCanvas=q({},f)},limitCanvas:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=j.aspectRatio,l=this.cropBox,m=this.cropped&&l,n=this.initialCanvas||j,o=n.width,p=n.height;a&&(c=ua(e.minCanvasWidth)||0,d=ua(e.minCanvasHeight)||0,c?(f&&(c=qa(m?l.width:o,c)),d=c/k):d?(f&&(d=qa(m?l.height:p,d)),c=d*k):f&&(m?(c=l.width,d=l.height,d*k>c?c=d*k:d=c/k):(c=o,d=p)),q(j,{minWidth:c,minHeight:d,maxWidth:1/0,maxHeight:1/0})),b&&(f?m?(j.minLeft=pa(l.left,l.left+l.width-j.width),j.minTop=pa(l.top,l.top+l.height-j.height),j.maxLeft=l.left,j.maxTop=l.top):(j.minLeft=pa(0,h-j.width),j.minTop=pa(0,i-j.height),j.maxLeft=qa(0,h-j.width),j.maxTop=qa(0,i-j.height)):(j.minLeft=-j.width,j.minTop=-j.height,j.maxLeft=h,j.maxTop=i))},renderCanvas:function(a){var b,c,d=this.options,e=this.canvas,f=this.image;this.rotated&&(this.rotated=!1,c=j({width:f.width,height:f.height,degree:f.rotate}),b=c.width/c.height,b!==e.aspectRatio&&(e.left-=(c.width-e.width)/2,e.top-=(c.height-e.height)/2,e.width=c.width,e.height=c.height,e.aspectRatio=b,this.limitCanvas(!0,!1))),(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=pa(qa(e.width,e.minWidth),e.maxWidth),e.height=pa(qa(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.oldLeft=e.left=pa(qa(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=pa(qa(e.top,e.minTop),e.maxTop),q(this.$canvas.style,{width:e.width+"px",height:e.height+"px",left:e.left+"px",top:e.top+"px"}),this.renderImage(),this.cropped&&d.strict&&this.limitCropBox(!0,!0),a&&this.output()},renderImage:function(){var a,b=this.canvas,c=this.image;c.rotate&&(a=j({width:b.width,height:b.height,degree:c.rotate,aspectRatio:c.aspectRatio},!0)),q(c,a?{width:a.width,height:a.height,left:(b.width-a.width)/2,top:(b.height-a.height)/2}:{width:b.width,height:b.height,left:0,top:0}),q(this.$clone.style,{width:c.width+"px",height:c.height+"px",marginLeft:c.left+"px",marginTop:c.top+"px",transform:i(c.rotate)})},initCropBox:function(){var a=this.options,b=this.canvas,c=a.aspectRatio,d=ua(a.autoCropArea)||.8,e={width:b.width,height:b.height};c&&(b.height*c>b.width?e.height=e.width/c:e.width=e.height*c),this.cropBox=e,this.limitCropBox(!0,!0),e.width=pa(qa(e.width,e.minWidth),e.maxWidth),e.height=pa(qa(e.height,e.minHeight),e.maxHeight),e.width=qa(e.minWidth,e.width*d),e.height=qa(e.minHeight,e.height*d),e.oldLeft=e.left=b.left+(b.width-e.width)/2,e.oldTop=e.top=b.top+(b.height-e.height)/2,this.initialCropBox=q({},e)},limitCropBox:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=this.cropBox,l=e.aspectRatio;a&&(c=ua(e.minCropBoxWidth)||0,d=ua(e.minCropBoxHeight)||0,k.minWidth=pa(h,c),k.minHeight=pa(i,d),k.maxWidth=pa(h,f?j.width:h),k.maxHeight=pa(i,f?j.height:i),l&&(k.maxHeight*l>k.maxWidth?(k.minHeight=k.minWidth/l,k.maxHeight=k.maxWidth/l):(k.minWidth=k.minHeight*l,k.maxWidth=k.maxHeight*l)),k.minWidth=pa(k.maxWidth,k.minWidth),k.minHeight=pa(k.maxHeight,k.minHeight)),b&&(f?(k.minLeft=qa(0,j.left),k.minTop=qa(0,j.top),k.maxLeft=pa(h,j.left+j.width)-k.width,k.maxTop=pa(i,j.top+j.height)-k.height):(k.minLeft=0,k.minTop=0,k.maxLeft=h-k.width,k.maxTop=i-k.height))},renderCropBox:function(){var a=this.options,b=this.container,c=b.width,d=b.height,e=this.cropBox;(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=pa(qa(e.width,e.minWidth),e.maxWidth),e.height=pa(qa(e.height,e.minHeight),e.maxHeight),this.limitCropBox(!1,!0),e.oldLeft=e.left=pa(qa(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=pa(qa(e.top,e.minTop),e.maxTop),a.movable&&a.cropBoxMovable&&this.$face.setAttribute("data-drag",e.width===c&&e.height===d?"move":"all"),q(this.$cropBox.style,{width:e.width+"px",height:e.height+"px",left:e.left+"px",top:e.top+"px"}),this.cropped&&a.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){var a=this.options,b=this.$element;this.preview(),a.crop&&a.crop.call(b,this.getData()),b.dispatchEvent(l(ma))}}),va.initPreview=function(){var a=this.url;this.$preview=c(document.querySelectorAll(this.options.preview||null)),this.$viewBox.innerHTML='<img src="'+a+'">',this.$preview.forEach(function(b){b.setAttribute(B,b.offsetWidth),b.setAttribute(C,b.offsetHeight),b.setAttribute(D,b.innerHTML),b.innerHTML='<img src="'+a+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">'})},va.resetPreview=function(){this.$preview.forEach(function(a){a.innerHTML=a.getAttribute(D),a.removeAttribute(D)})},va.preview=function(){var a=this.image,b=this.canvas,d=this.cropBox,e=a.width,f=a.height,g=d.left-b.left-a.left,h=d.top-b.top-a.top,j=a.rotate;this.cropped&&!this.disabled&&(c(this.$viewBox.querySelectorAll("img")).forEach(function(a){q(a.style,{width:e+"px",height:f+"px",marginLeft:-g+"px",marginTop:-h+"px",transform:i(j)})}),this.$preview.forEach(function(a){var b={width:parseFloat(a.getAttribute(B)),height:parseFloat(a.getAttribute(C))},k=b.width/d.width,l=b.width,m=d.height*k;m>b.height&&(k=b.height/d.height,l=d.width*k,m=b.height),q(a.style,{width:l+"px",height:m+"px"}),c(a.querySelectorAll("img")).forEach(function(a){q(a.style,{width:e*k+"px",height:f*k+"px",marginLeft:-g*k+"px",marginTop:-h*k+"px",transform:i(j)})})}))},va.addListeners=function(){var a=this.options,b=this.$element,c=this.$cropper;e(a.dragstart)&&m(b,ha,a.dragstart),e(a.dragmove)&&m(b,ia,a.dragmove),e(a.dragend)&&m(b,ja,a.dragend),e(a.zoomin)&&m(b,ka,a.zoomin),e(a.zoomout)&&m(b,la,a.zoomout),e(a.change)&&m(b,ma,a.change),m(c,N,this._dragstart=f(this.dragstart,this)),m(c,O,this._dragstart),m(c,P,this._dragstart),m(c,Q,this._dragstart),a.zoomable&&a.mouseWheelZoom&&(m(c,aa,this._wheel=f(this.wheel,this)),m(c,ba,this._wheel),m(c,ca,this._wheel)),a.doubleClickToggle&&m(c,da,this._dblclick=f(this.dblclick,this)),m(document,R,this._dragmove=f(this.dragmove,this)),m(document,S,this._dragmove),m(document,T,this._dragmove),m(document,U,this._dragmove),m(document,V,this._dragend=f(this.dragend,this)),m(document,W,this._dragend),m(document,X,this._dragend),m(document,Y,this._dragend),m(document,$,this._dragend),m(document,Z,this._dragend),m(document,_,this._dragend),a.responsive&&m(window,ea,this._resize=f(this.resize,this))},va.removeListeners=function(){var a=this.options,b=this.$element,c=this.$cropper;e(a.dragstart)&&o(b,ha,a.dragstart),e(a.dragmove)&&o(b,ia,a.dragmove),e(a.dragend)&&o(b,ja,a.dragend),e(a.zoomin)&&o(b,ka,a.zoomin),e(a.zoomout)&&o(b,la,a.zoomout),e(a.change)&&o(b,ma,a.change),o(c,N,this._dragstart),o(c,O,this._dragstart),o(c,P,this._dragstart),o(c,Q,this._dragstart),a.zoomable&&a.mouseWheelZoom&&(o(c,aa,this._wheel),o(c,ba,this._wheel),o(c,ca,this._wheel)),a.doubleClickToggle&&o(c,da,this._dblclick),o(document,R,this._dragmove),o(document,S,this._dragmove),o(document,T,this._dragmove),o(document,U,this._dragmove),o(document,V,this._dragend),o(document,W,this._dragend),o(document,X,this._dragend),o(document,Y,this._dragend),o(document,$,this._dragend),o(document,Z,this._dragend),o(document,_,this._dragend),a.responsive&&o(window,ea,this._resize)},q(va,{resize:function(){var a,b,c,d=this.$container,e=this.container;if(!this.disabled&&e&&(c=d.offsetWidth/e.width,1!==c||d.offsetHeight!==e.height)){a=this.getCanvasData(),b=this.getCropBoxData(),this.render();for(var f in a)a.hasOwnProperty(f)&&(a[f]=a[f]*c);this.setCanvasData(a);for(f in b)b.hasOwnProperty(f)&&(b[f]=b[f]*c);this.setCropBoxData(b)}},dblclick:function(){this.disabled||(t(this.$dragBox,K)?this.setDragMode("move"):this.setDragMode("crop"))},wheel:function(a){var b=1;this.disabled||(a.preventDefault(),a.deltaY?b=a.deltaY>0?1:-1:a.wheelDelta?b=-a.wheelDelta/120:a.detail&&(b=a.detail>0?1:-1),this.zoom(.1*-b))},dragstart:function(a){var b,c,d,e=this.options,f=a&&a.touches,g=a;if(!this.disabled){if(f){if(d=f.length,d>1){if(!e.zoomable||!e.touchDragZoom||2!==d)return;g=f[1],this.startX2=g.pageX,this.startY2=g.pageY,b="zoom"}g=f[0]}if(b=b||g.target.getAttribute("data-drag"),E.test(b)){if(a.preventDefault(),c=l(ha,{originalEvent:a,dragType:b}),this.$element.dispatchEvent(c),c.defaultPrevented)return;this.dragType=b,this.cropping=!1,this.startX=g.pageX,this.startY=g.pageY,"crop"===b&&(this.cropping=!0,v(this.$dragBox,F))}}},dragmove:function(a){var b,c,d=this.options,e=a&&a.touches,f=a,g=this.dragType;if(!this.disabled){if(e){if(c=e.length,c>1){if(!d.zoomable||!d.touchDragZoom||2!==c)return;f=e[1],this.endX2=f.pageX,this.endY2=f.pageY}f=e[0]}if(g){if(a.preventDefault(),b=l(ia,{originalEvent:a,dragType:g}),this.$element.dispatchEvent(b),b.defaultPrevented)return;this.endX=f.pageX,this.endY=f.pageY,this.change(f.shiftKey)}}},dragend:function(a){var b,c=this.dragType;if(!this.disabled&&c){if(a.preventDefault(),b=l(ja,{originalEvent:a,dragType:c}),this.$element.dispatchEvent(b),b.defaultPrevented)return;this.cropping&&(this.cropping=!1,u(this.$dragBox,F,this.cropped&&this.options.modal)),this.dragType=""}}}),q(va,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&v(this.$dragBox,F),w(this.$cropBox,H)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=q({},this.initialImage),this.canvas=q({},this.initialCanvas),this.cropBox=q({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(q(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),w(this.$dragBox,F),v(this.$cropBox,H))},destroy:function(){var a=this.$element;this.ready?(this.unbuild(),w(a,H)):this.$clone&&r(this.$clone)},replace:function(a){!this.disabled&&a&&(this.options.data=null,this.load(a))},enable:function(){this.built&&(this.disabled=!1,w(this.$cropper,L))},disable:function(){this.built&&(this.disabled=!0,v(this.$cropper,L))},move:function(b,c){var d=this.canvas;this.built&&!this.disabled&&this.options.movable&&a(b)&&a(c)&&(d.left+=b,d.top+=c,this.renderCanvas(!0))},zoom:function(a){var b,c,d,e=this.canvas;if(a=ua(a),a&&this.built&&!this.disabled&&this.options.zoomable){if(b=l(a>0?ka:la),this.$element.dispatchEvent(b),b.defaultPrevented)return;a=-1>=a?1/(1-a):1>=a?1+a:a,c=e.width*a,d=e.height*a,e.left-=(c-e.width)/2,e.top-=(d-e.height)/2,e.width=c,e.height=d,this.renderCanvas(!0),this.setDragMode("move")}},rotate:function(a){var b=this.image;a=ua(a),a&&this.built&&!this.disabled&&this.options.rotatable&&(b.rotate=(b.rotate+a)%360,this.rotated=!0,this.renderCanvas(!0))},getData:function(a){var b,c,d,e=this.cropBox,f=this.canvas,g=this.image;if(this.built&&this.cropped){c={x:e.left-f.left,y:e.top-f.top,width:e.width,height:e.height},b=g.width/g.naturalWidth;for(var h in c)c.hasOwnProperty(h)&&(d=c[h]/b,c[h]=a?Math.round(d):d)}else c={x:0,y:0,width:0,height:0};return c.rotate=this.ready?g.rotate:0,c},setData:function(b){var c,e=this.image,f=this.canvas,g={};this.built&&!this.disabled&&d(b)&&(a(b.rotate)&&b.rotate!==e.rotate&&this.options.rotatable&&(e.rotate=b.rotate,this.rotated=!0,this.renderCanvas(!0)),c=e.width/e.naturalWidth,a(b.x)&&(g.left=b.x*c+f.left),a(b.y)&&(g.top=b.y*c+f.top),a(b.width)&&(g.width=b.width*c),a(b.height)&&(g.height=b.height*c),this.setCropBoxData(g))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a,b=this.canvas;return this.built&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCanvasData:function(b){var c=this.canvas,e=c.aspectRatio;this.built&&!this.disabled&&d(b)&&(a(b.left)&&(c.left=b.left),a(b.top)&&(c.top=b.top),a(b.width)?(c.width=b.width,c.height=b.width/e):a(b.height)&&(c.height=b.height,c.width=b.height*e),this.renderCanvas(!0))},getCropBoxData:function(){var a,b=this.cropBox;return this.built&&this.cropped&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCropBoxData:function(b){var c=this.cropBox,e=this.options.aspectRatio;this.built&&this.cropped&&!this.disabled&&d(b)&&(a(b.left)&&(c.left=b.left),a(b.top)&&(c.top=b.top),a(b.width)&&(c.width=b.width),a(b.height)&&(c.height=b.height),e&&(a(b.width)?c.height=c.width/e:a(b.height)&&(c.width=c.height*e)),this.renderCropBox())},getCroppedCanvas:function(a){var b,c,e,f,g,h,i,j,l,m,n;if(this.built&&this.cropped&&na)return d(a)||(a={}),n=this.getData(),b=n.width,c=n.height,j=b/c,d(a)&&(g=a.width,h=a.height,g?(h=g/j,i=g/b):h&&(g=h*j,i=h/c)),e=g||b,f=h||c,l=document.createElement("canvas"),l.width=e,l.height=f,m=l.getContext("2d"),a.fillColor&&(m.fillStyle=a.fillColor,m.fillRect(0,0,e,f)),m.drawImage.apply(m,function(){var a,d,e,f,g,h,j=k(this.$clone,this.image),l=j.width,m=j.height,o=[j],p=n.x,q=n.y;return-b>=p||p>l?p=a=e=g=0:0>=p?(e=-p,p=0,a=g=pa(l,b+p)):l>=p&&(e=0,a=g=pa(b,l-p)),0>=a||-c>=q||q>m?q=d=f=h=0:0>=q?(f=-q,q=0,d=h=pa(m,c+q)):m>=q&&(f=0,d=h=pa(c,m-q)),o.push(p,q,a,d),i&&(e*=i,f*=i,g*=i,h*=i),g>0&&h>0&&o.push(e,f,g,h),o}.call(this)),l},setAspectRatio:function(a){var c=this.options;this.disabled||b(a)||(c.aspectRatio=ua(a)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var b,c,d=this.options;this.ready&&!this.disabled&&(b=d.dragCrop&&"crop"===a,c=d.movable&&"move"===a,a=b||c?a:"none",this.$dragBox.setAttribute("data-drag",a),u(this.$dragBox,K,b),u(this.$dragBox,J,c),d.cropBoxMovable||(this.$face.setAttribute("data-drag",a),u(this.$face,K,b),u(this.$face,J,c)))}}),va.change=function(a){var b,c=this.dragType,d=this.options,e=this.canvas,f=this.container,g=this.cropBox,h=g.width,i=g.height,j=g.left,k=g.top,l=j+h,m=k+i,n=0,o=0,p=f.width,q=f.height,r=!0,s=d.aspectRatio,t={x:this.endX-this.startX,y:this.endY-this.startY};switch(!s&&a&&(s=h&&i?h/i:1),d.strict&&(n=g.minLeft,o=g.minTop,p=n+pa(f.width,e.width),q=o+pa(f.height,e.height)),s&&(t.X=t.y*s,t.Y=t.x/s),c){case"all":j+=t.x,k+=t.y;break;case"e":if(t.x>=0&&(l>=p||s&&(o>=k||m>=q))){r=!1;break}h+=t.x,s&&(i=h/s,k-=t.Y/2),0>h&&(c="w",h=0);break;case"n":if(t.y<=0&&(o>=k||s&&(n>=j||l>=p))){r=!1;break}i-=t.y,k+=t.y,s&&(h=i*s,j+=t.X/2),0>i&&(c="s",i=0);break;case"w":if(t.x<=0&&(n>=j||s&&(o>=k||m>=q))){r=!1;break}h-=t.x,j+=t.x,s&&(i=h/s,k+=t.Y/2),0>h&&(c="e",h=0);break;case"s":if(t.y>=0&&(m>=q||s&&(n>=j||l>=p))){r=!1;break}i+=t.y,s&&(h=i*s,j-=t.X/2),0>i&&(c="n",i=0);break;case"ne":if(s){if(t.y<=0&&(o>=k||l>=p)){r=!1;break}i-=t.y,k+=t.y,h=i*s}else t.x>=0?p>l?h+=t.x:t.y<=0&&o>=k&&(r=!1):h+=t.x,t.y<=0?k>o&&(i-=t.y,k+=t.y):(i-=t.y,k+=t.y);0>h&&0>i?(c="sw",i=0,h=0):0>h?(c="nw",h=0):0>i&&(c="se",i=0);break;case"nw":if(s){if(t.y<=0&&(o>=k||n>=j)){r=!1;break}i-=t.y,k+=t.y,h=i*s,j+=t.X}else t.x<=0?j>n?(h-=t.x,j+=t.x):t.y<=0&&o>=k&&(r=!1):(h-=t.x,j+=t.x),t.y<=0?k>o&&(i-=t.y,k+=t.y):(i-=t.y,k+=t.y);0>h&&0>i?(c="se",i=0,h=0):0>h?(c="ne",h=0):0>i&&(c="sw",i=0);break;case"sw":if(s){if(t.x<=0&&(n>=j||m>=q)){r=!1;break}h-=t.x,j+=t.x,i=h/s}else t.x<=0?j>n?(h-=t.x,j+=t.x):t.y>=0&&m>=q&&(r=!1):(h-=t.x,j+=t.x),t.y>=0?q>m&&(i+=t.y):i+=t.y;0>h&&0>i?(c="ne",i=0,h=0):0>h?(c="se",h=0):0>i&&(c="nw",i=0);break;case"se":if(s){if(t.x>=0&&(l>=p||m>=q)){r=!1;break}h+=t.x,i=h/s}else t.x>=0?p>l?h+=t.x:t.y>=0&&m>=q&&(r=!1):h+=t.x,t.y>=0?q>m&&(i+=t.y):i+=t.y;0>h&&0>i?(c="nw",i=0,h=0):0>h?(c="sw",h=0):0>i&&(c="ne",i=0);break;case"move":e.left+=t.x,e.top+=t.y,this.renderCanvas(!0),r=!1;break;case"zoom":this.zoom(function(a,b,c,d){var e=oa(a*a+b*b),f=oa(c*c+d*d);return(f-e)/e}(ra(this.startX-this.startX2),ra(this.startY-this.startY2),ra(this.endX-this.endX2),ra(this.endY-this.endY2))),this.startX2=this.endX2,this.startY2=this.endY2,r=!1;break;case"crop":if(t.x&&t.y){var u=this.$cropper.getBoundingClientRect();b={top:u.top+document.body.scrollTop,left:u.left+document.body.scrollLeft},j=this.startX-b.left,k=this.startY-b.top,h=g.minWidth,i=g.minHeight,t.x>0?t.y>0?c="se":(c="ne",k-=i):t.y>0?(c="sw",j-=h):(c="nw",j-=h,k-=i),this.cropped||(this.cropped=!0,w(this.$cropBox,H))}}r&&(g.width=h,g.height=i,g.left=j,g.top=k,this.dragType=c,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},q(x.prototype,va),x.DEFAULTS={aspectRatio:NaN,autoCropArea:.8,crop:null,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,highlight:!0,background:!0,autoCrop:!0,dragCrop:!0,movable:!0,rotatable:!0,zoomable:!0,touchDragZoom:!0,mouseWheelZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null,change:null},x.setDefaults=function(a){q(x.DEFAULTS,a)},x.TEMPLATE=function(a,b){return b=b.split(","),a.replace(/\d+/g,function(a){return b[a]})}('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,drag,data,point,cropper,class,line,dashed,box"),x});