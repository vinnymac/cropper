/*!
 * Cropper v@VERSION
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-@YEAR Fengyuan Chen and contributors
 * Released under the MIT license
 *
 * Date: @DATE
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function b(a){return"number"==typeof a&&!isNaN(a)}function c(a){return"undefined"==typeof a}function d(a,c){var d=[];return b(c)&&d.push(c),d.slice.apply(a,d)}function e(a,b){var c=d(arguments,2);return function(){return a.apply(b,c.concat(d(arguments)))}}function f(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==u.protocol||b[2]!==u.hostname||b[3]!==u.port)}function g(a){var b="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+b}function h(a){return a?"rotate("+a+"deg)":"none"}function i(a,b){var c,d,e=X(a.degree)%180,f=(e>90?180-e:e)*Math.PI/180,g=Y(f),h=Z(f),i=a.width,j=a.height,k=a.aspectRatio;return b?(c=i/(h+g/k),d=c/k):(c=i*h+j*g,d=i*g+j*h),{width:c,height:d}}function j(b,c){var d=a("<canvas>")[0],e=d.getContext("2d"),f=c.naturalWidth,g=c.naturalHeight,h=c.rotate,j=i({width:f,height:g,degree:h});return h?(d.width=j.width,d.height=j.height,e.save(),e.translate(j.width/2,j.height/2),e.rotate(h*Math.PI/180),e.drawImage(b,-f/2,-g/2,f,g),e.restore()):(d.width=f,d.height=g,e.drawImage(b,0,0,f,g)),d}function k(a){if(null===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function l(a,b){if(Object.assign)return Object.assign(a,b);for(var c,d,e=k(a),f=1;f<arguments.length;f++){c=arguments[f],d=Object.keys(Object(c));for(var g=0;g<d.length;g++)e[d[g]]=c[d[g]]}return e}function m(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)}function n(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function o(a,b,c){if(a.classList)"undefined"===c||null===c?a.classList.toggle(b):c?a.classList.add(b):a.classList.remove(b);else{var d=a.className.split(" "),e=d.indexOf(b);"undefined"===c||null===c?e>=0?d.splice(e,1):d.push(b):c?d.push(b):d.splice(e,1),a.className=d.join(" ")}}function p(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function q(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function r(b,c){this.$element=a(b),this.options=l({},r.DEFAULTS,a.isPlainObject(c)&&c),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.canvas=null,this.cropBox=null,this.load()}var s=a(window),t=a(document),u=window.location,v=".cropper",w="preview"+v,x=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,y="cropper-modal",z="cropper-hide",A="cropper-hidden",B="cropper-invisible",C="cropper-move",D="cropper-crop",E="cropper-disabled",F="cropper-bg",G="mousedown touchstart",H="mousemove touchmove",I="mouseup mouseleave touchend touchleave touchcancel",J="wheel mousewheel DOMMouseScroll",K="dblclick",L="resize"+v,M="build"+v,N="built"+v,O="dragstart"+v,P="dragmove"+v,Q="dragend"+v,R="zoomin"+v,S="zoomout"+v,T="function"==typeof a("<canvas>")[0].getContext||!1,U=Math.sqrt,V=Math.min,W=Math.max,X=Math.abs,Y=Math.sin,Z=Math.cos,$=parseFloat,_={};_.load=function(b){var c,d,h,i,j=this.options,k=this.$element;if(!b)if(k.is("img")){if(!k.attr("src"))return;b=k.prop("src")}else k.is("canvas")&&T&&(b=k[0].toDataURL());b&&(h=a.Event(M),k.one(M,j.build).trigger(h),h.isDefaultPrevented()||(j.checkImageOrigin&&f(b)&&(c="anonymous",k.prop("crossOrigin")||(d=g(b))),this.$clone=i=a("<img>"),i.one("load",e(function(){var a=i.prop("naturalWidth")||i.width(),c=i.prop("naturalHeight")||i.height();this.image={naturalWidth:a,naturalHeight:c,aspectRatio:a/c,rotate:0},this.url=b,this.ready=!0,this.build()},this)).one("error",function(){i.remove()}).attr({crossOrigin:c,src:d||b}),p(i.get(0),z),m(k.get(0),i.get(0))))},_.build=function(){var b,c,d=this.$element,e=this.$clone,f=this.options;if(this.ready){if(this.built&&this.unbuild(),this.$cropper=b=a(r.TEMPLATE),p(d.get(0),A),q(e.get(0),z),this.$container=d.parent().append(b),this.$canvas=b.find(".cropper-canvas").append(e),this.$dragBox=b.find(".cropper-drag-box"),this.$cropBox=c=b.find(".cropper-crop-box"),this.$viewBox=b.find(".cropper-view-box"),this.addListeners(),this.initPreview(),f.aspectRatio=$(f.aspectRatio)||NaN,f.autoCrop?(this.cropped=!0,f.modal&&p(this.$dragBox.get(0),y)):p(c.get(0),A),f.background&&p(b.get(0),F),!f.highlight){var g=c.find(".cropper-face");p(g.get(0),B)}if(!f.guides){var h=c.find(".cropper-dashed");p(h.get(0),A)}if(f.movable||c.find(".cropper-face").data("drag","move"),!f.resizable){var i=c.find(".cropper-line, .cropper-point");p(i.get(0),A)}this.setDragMode(f.dragCrop?"crop":"move"),this.built=!0,this.render(),this.setData(f.data),d.one(N,f.built).trigger(N)}},_.unbuild=function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.removeListeners(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},l(_,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.$element,b=this.$container,c=this.$cropper,d=this.options;p(c.get(0),A),q(a.get(0),A),c.css(this.container={width:W(b.width(),$(d.minContainerWidth)||200),height:W(b.height(),$(d.minContainerHeight)||100)}),p(a.get(0),A),q(c.get(0),A)},initCanvas:function(){var a=this.container,b=a.width,c=a.height,d=this.image,e=d.aspectRatio,f={aspectRatio:e,width:b,height:c};c*e>b?f.height=b/e:f.width=c*e,f.oldLeft=f.left=(b-f.width)/2,f.oldTop=f.top=(c-f.height)/2,this.canvas=f,this.limitCanvas(!0,!0),this.initialImage=l({},d),this.initialCanvas=l({},f)},limitCanvas:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=j.aspectRatio,m=this.cropBox,n=this.cropped&&m,o=this.initialCanvas||j,p=o.width,q=o.height;a&&(c=$(e.minCanvasWidth)||0,d=$(e.minCanvasHeight)||0,c?(f&&(c=W(n?m.width:p,c)),d=c/k):d?(f&&(d=W(n?m.height:q,d)),c=d*k):f&&(n?(c=m.width,d=m.height,d*k>c?c=d*k:d=c/k):(c=p,d=q)),l(j,{minWidth:c,minHeight:d,maxWidth:1/0,maxHeight:1/0})),b&&(f?n?(j.minLeft=V(m.left,m.left+m.width-j.width),j.minTop=V(m.top,m.top+m.height-j.height),j.maxLeft=m.left,j.maxTop=m.top):(j.minLeft=V(0,h-j.width),j.minTop=V(0,i-j.height),j.maxLeft=W(0,h-j.width),j.maxTop=W(0,i-j.height)):(j.minLeft=-j.width,j.minTop=-j.height,j.maxLeft=h,j.maxTop=i))},renderCanvas:function(a){var b,c,d=this.options,e=this.canvas,f=this.image;this.rotated&&(this.rotated=!1,c=i({width:f.width,height:f.height,degree:f.rotate}),b=c.width/c.height,b!==e.aspectRatio&&(e.left-=(c.width-e.width)/2,e.top-=(c.height-e.height)/2,e.width=c.width,e.height=c.height,e.aspectRatio=b,this.limitCanvas(!0,!1))),(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=V(W(e.width,e.minWidth),e.maxWidth),e.height=V(W(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.oldLeft=e.left=V(W(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=V(W(e.top,e.minTop),e.maxTop),this.$canvas.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.renderImage(),this.cropped&&d.strict&&this.limitCropBox(!0,!0),a&&this.output()},renderImage:function(){var a,b=this.canvas,c=this.image;c.rotate&&(a=i({width:b.width,height:b.height,degree:c.rotate,aspectRatio:c.aspectRatio},!0)),l(c,a?{width:a.width,height:a.height,left:(b.width-a.width)/2,top:(b.height-a.height)/2}:{width:b.width,height:b.height,left:0,top:0}),this.$clone.css({width:c.width,height:c.height,marginLeft:c.left,marginTop:c.top,transform:h(c.rotate)})},initCropBox:function(){var a=this.options,b=this.canvas,c=a.aspectRatio,d=$(a.autoCropArea)||.8,e={width:b.width,height:b.height};c&&(b.height*c>b.width?e.height=e.width/c:e.width=e.height*c),this.cropBox=e,this.limitCropBox(!0,!0),e.width=V(W(e.width,e.minWidth),e.maxWidth),e.height=V(W(e.height,e.minHeight),e.maxHeight),e.width=W(e.minWidth,e.width*d),e.height=W(e.minHeight,e.height*d),e.oldLeft=e.left=b.left+(b.width-e.width)/2,e.oldTop=e.top=b.top+(b.height-e.height)/2,this.initialCropBox=l({},e)},limitCropBox:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=this.cropBox,l=e.aspectRatio;a&&(c=$(e.minCropBoxWidth)||0,d=$(e.minCropBoxHeight)||0,k.minWidth=V(h,c),k.minHeight=V(i,d),k.maxWidth=V(h,f?j.width:h),k.maxHeight=V(i,f?j.height:i),l&&(k.maxHeight*l>k.maxWidth?(k.minHeight=k.minWidth/l,k.maxHeight=k.maxWidth/l):(k.minWidth=k.minHeight*l,k.maxWidth=k.maxHeight*l)),k.minWidth=V(k.maxWidth,k.minWidth),k.minHeight=V(k.maxHeight,k.minHeight)),b&&(f?(k.minLeft=W(0,j.left),k.minTop=W(0,j.top),k.maxLeft=V(h,j.left+j.width)-k.width,k.maxTop=V(i,j.top+j.height)-k.height):(k.minLeft=0,k.minTop=0,k.maxLeft=h-k.width,k.maxTop=i-k.height))},renderCropBox:function(){var a=this.options,b=this.container,c=b.width,d=b.height,e=this.$cropBox,f=this.cropBox;(f.width>f.maxWidth||f.width<f.minWidth)&&(f.left=f.oldLeft),(f.height>f.maxHeight||f.height<f.minHeight)&&(f.top=f.oldTop),f.width=V(W(f.width,f.minWidth),f.maxWidth),f.height=V(W(f.height,f.minHeight),f.maxHeight),this.limitCropBox(!1,!0),f.oldLeft=f.left=V(W(f.left,f.minLeft),f.maxLeft),f.oldTop=f.top=V(W(f.top,f.minTop),f.maxTop),a.movable&&e.find(".cropper-face").data("drag",f.width===c&&f.height===d?"move":"all"),e.css({width:f.width,height:f.height,left:f.left,top:f.top}),this.cropped&&a.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){var a=this.options;this.preview(),a.crop&&a.crop.call(this.$element,this.getData())}}),_.initPreview=function(){var b=this.url;this.$preview=a(this.options.preview),this.$viewBox.html('<img src="'+b+'">'),this.$preview.each(function(){var c=a(this);c.data(w,{width:c.width(),height:c.height(),original:c.html()}).html('<img src="'+b+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">')})},_.resetPreview=function(){this.$preview.each(function(){var b=a(this);b.html(b.data(w).original).removeData(w)})},_.preview=function(){var b=this.image,c=this.canvas,d=this.cropBox,e=b.width,f=b.height,g=d.left-c.left-b.left,i=d.top-c.top-b.top,j=b.rotate;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:e,height:f,marginLeft:-g,marginTop:-i,transform:h(j)}),this.$preview.each(function(){var b=a(this),c=b.data(w),k=c.width/d.width,l=c.width,m=d.height*k;m>c.height&&(k=c.height/d.height,l=d.width*k,m=c.height),b.width(l).height(m).find("img").css({width:e*k,height:f*k,marginLeft:-g*k,marginTop:-i*k,transform:h(j)})}))},_.addListeners=function(){var a=this.options;this.$element.on(O,a.dragstart).on(P,a.dragmove).on(Q,a.dragend).on(R,a.zoomin).on(S,a.zoomout),this.$cropper.on(G,this._dragstart=e(this.dragstart,this)).on(K,this._dblclick=e(this.dblclick,this)),a.zoomable&&a.mouseWheelZoom&&this.$cropper.on(J,this._wheel=e(this.wheel,this)),t.on(H,this._dragmove=e(this.dragmove,this)).on(I,this._dragend=e(this.dragend,this)),a.responsive&&s.on(L,this._resize=e(this.resize,this))},_.removeListeners=function(){var a=this.options;this.$element.off(O,a.dragstart).off(P,a.dragmove).off(Q,a.dragend).off(R,a.zoomin).off(S,a.zoomout),this.$cropper.off(G,this.dragstart).off(K,this.dblclick),a.zoomable&&a.mouseWheelZoom&&this.$cropper.off(J,this.wheel),t.off(H,this._dragmove).off(I,this._dragend),a.responsive&&s.off(L,this._resize)},l(_,{resize:function(){var b,c,d,e=this.$container,f=this.container;this.disabled||(d=e.width()/f.width,(1!==d||e.height()!==f.height)&&(b=this.getCanvasData(),c=this.getCropBoxData(),this.render(),this.setCanvasData(a.each(b,function(a,c){b[a]=c*d})),this.setCropBoxData(a.each(c,function(a,b){c[a]=b*d}))))},dblclick:function(){this.disabled||this.setDragMode(n(this.$dragBox.get(0),D)?"move":"crop")},wheel:function(a){var b=a.originalEvent,c=1;this.disabled||(a.preventDefault(),b.deltaY?c=b.deltaY>0?1:-1:b.wheelDelta?c=-b.wheelDelta/120:b.detail&&(c=b.detail>0?1:-1),this.zoom(.1*-c))},dragstart:function(b){var c,d,e,f=this.options,g=b.originalEvent,h=g&&g.touches,i=b;if(!this.disabled){if(h){if(e=h.length,e>1){if(!f.zoomable||!f.touchDragZoom||2!==e)return;i=h[1],this.startX2=i.pageX,this.startY2=i.pageY,c="zoom"}i=h[0]}if(c=c||a(i.target).data("drag"),x.test(c)){if(b.preventDefault(),d=a.Event(O,{originalEvent:g,dragType:c}),this.$element.trigger(d),d.isDefaultPrevented())return;this.dragType=c,this.cropping=!1,this.startX=i.pageX,this.startY=i.pageY,"crop"===c&&(this.cropping=!0,p(this.$dragBox.get(0),y))}}},dragmove:function(b){var c,d,e=this.options,f=b.originalEvent,g=f&&f.touches,h=b,i=this.dragType;if(!this.disabled){if(g){if(d=g.length,d>1){if(!e.zoomable||!e.touchDragZoom||2!==d)return;h=g[1],this.endX2=h.pageX,this.endY2=h.pageY}h=g[0]}if(i){if(b.preventDefault(),c=a.Event(P,{originalEvent:f,dragType:i}),this.$element.trigger(c),c.isDefaultPrevented())return;this.endX=h.pageX,this.endY=h.pageY,this.change()}}},dragend:function(b){var c,d=this.dragType;if(!this.disabled&&d){if(b.preventDefault(),c=a.Event(Q,{originalEvent:b.originalEvent,dragType:d}),this.$element.trigger(c),c.isDefaultPrevented())return;this.cropping&&(this.cropping=!1,o(this.$dragBox.get(0),y,this.cropped&&this.options.modal)),this.dragType=""}}}),l(_,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&p(this.$dragBox.get(0),y),q(this.$cropBox.get(0),A)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=l({},this.initialImage),this.canvas=l({},this.initialCanvas),this.cropBox=l({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(l(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),q(this.$dragBox.get(0),y),p(this.$cropBox.get(0),A))},destroy:function(){var a=this.$element;this.ready?(this.unbuild(),q(a.get(0),A)):this.$clone&&this.$clone.remove(),a.removeData("cropper")},replace:function(a){!this.disabled&&a&&(this.options.data=null,this.load(a))},enable:function(){this.built&&(this.disabled=!1,q(this.$cropper.get(0),E))},disable:function(){this.built&&(this.disabled=!0,p(this.$cropper.get(0),E))},move:function(a,c){var d=this.canvas;this.built&&!this.disabled&&b(a)&&b(c)&&(d.left+=a,d.top+=c,this.renderCanvas(!0))},zoom:function(b){var c,d,e,f=this.canvas;if(b=$(b),b&&this.built&&!this.disabled&&this.options.zoomable){if(c=a.Event(b>0?R:S),this.$element.trigger(c),c.isDefaultPrevented())return;b=-1>=b?1/(1-b):1>=b?1+b:b,d=f.width*b,e=f.height*b,f.left-=(d-f.width)/2,f.top-=(e-f.height)/2,f.width=d,f.height=e,this.renderCanvas(!0),this.setDragMode("move")}},rotate:function(a){var b=this.image;a=$(a),a&&this.built&&!this.disabled&&this.options.rotatable&&(b.rotate=(b.rotate+a)%360,this.rotated=!0,this.renderCanvas(!0))},getData:function(){var b,c,d=this.cropBox,e=this.canvas,f=this.image;return this.built&&this.cropped?(c={x:d.left-e.left,y:d.top-e.top,width:d.width,height:d.height},b=f.width/f.naturalWidth,a.each(c,function(a,d){d/=b,c[a]=d})):c={x:0,y:0,width:0,height:0},c.rotate=this.ready?f.rotate:0,c},setData:function(c){var d,e=this.image,f=this.canvas,g={};this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.rotate)&&c.rotate!==e.rotate&&this.options.rotatable&&(e.rotate=c.rotate,this.rotated=!0,this.renderCanvas(!0)),d=e.width/e.naturalWidth,b(c.x)&&(g.left=c.x*d+f.left),b(c.y)&&(g.top=c.y*d+f.top),b(c.width)&&(g.width=c.width*d),b(c.height)&&(g.height=c.height*d),this.setCropBoxData(g))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a,b=this.canvas;return this.built&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCanvasData:function(c){var d=this.canvas,e=d.aspectRatio;this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),b(c.width)?(d.width=c.width,d.height=c.width/e):b(c.height)&&(d.height=c.height,d.width=c.height*e),this.renderCanvas(!0))},getCropBoxData:function(){var a,b=this.cropBox;return this.built&&this.cropped&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCropBoxData:function(c){var d=this.cropBox,e=this.options.aspectRatio;this.built&&this.cropped&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),b(c.width)&&(d.width=c.width),b(c.height)&&(d.height=c.height),e&&(b(c.width)?d.height=d.width/e:b(c.height)&&(d.width=d.height*e)),this.renderCropBox())},getCroppedCanvas:function(b){var c,d,e,f,g,h,i,k,l,m,n;if(this.built&&this.cropped&&T)return a.isPlainObject(b)||(b={}),n=this.getData(),c=n.width,d=n.height,k=c/d,a.isPlainObject(b)&&(g=b.width,h=b.height,g?(h=g/k,i=g/c):h&&(g=h*k,i=h/d)),e=g||c,f=h||d,l=a("<canvas>")[0],l.width=e,l.height=f,m=l.getContext("2d"),b.fillColor&&(m.fillStyle=b.fillColor,m.fillRect(0,0,e,f)),m.drawImage.apply(m,function(){var a,b,e,f,g,h,k=j(this.$clone[0],this.image),l=k.width,m=k.height,o=[k],p=n.x,q=n.y;return-c>=p||p>l?p=a=e=g=0:0>=p?(e=-p,p=0,a=g=V(l,c+p)):l>=p&&(e=0,a=g=V(c,l-p)),0>=a||-d>=q||q>m?q=b=f=h=0:0>=q?(f=-q,q=0,b=h=V(m,d+q)):m>=q&&(f=0,b=h=V(d,m-q)),o.push(p,q,a,b),i&&(e*=i,f*=i,g*=i,h*=i),g>0&&h>0&&o.push(e,f,g,h),o}.call(this)),l},setAspectRatio:function(a){var b=this.options;this.disabled||c(a)||(b.aspectRatio=$(a)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var b=this.$dragBox,c=!1,d=!1;if(this.ready&&!this.disabled){switch(a){case"crop":this.options.dragCrop?(c=!0,b.data("drag",a)):d=!0;break;case"move":d=!0,b.data("drag",a);break;default:b.removeData("drag")}o(b.get(0),D,c),o(b.get(0),C,d)}}}),_.change=function(){var a,b=this.dragType,c=this.options,d=this.canvas,e=this.container,f=this.cropBox,g=f.width,h=f.height,i=f.left,j=f.top,k=i+g,l=j+h,m=0,n=0,o=e.width,p=e.height,r=!0,s=c.aspectRatio,t={x:this.endX-this.startX,y:this.endY-this.startY};switch(c.strict&&(m=f.minLeft,n=f.minTop,o=m+V(e.width,d.width),p=n+V(e.height,d.height)),s&&(t.X=t.y*s,t.Y=t.x/s),b){case"all":i+=t.x,j+=t.y;break;case"e":if(t.x>=0&&(k>=o||s&&(n>=j||l>=p))){r=!1;break}g+=t.x,s&&(h=g/s,j-=t.Y/2),0>g&&(b="w",g=0);break;case"n":if(t.y<=0&&(n>=j||s&&(m>=i||k>=o))){r=!1;break}h-=t.y,j+=t.y,s&&(g=h*s,i+=t.X/2),0>h&&(b="s",h=0);break;case"w":if(t.x<=0&&(m>=i||s&&(n>=j||l>=p))){r=!1;break}g-=t.x,i+=t.x,s&&(h=g/s,j+=t.Y/2),0>g&&(b="e",g=0);break;case"s":if(t.y>=0&&(l>=p||s&&(m>=i||k>=o))){r=!1;break}h+=t.y,s&&(g=h*s,i-=t.X/2),0>h&&(b="n",h=0);break;case"ne":if(s){if(t.y<=0&&(n>=j||k>=o)){r=!1;break}h-=t.y,j+=t.y,g=h*s}else t.x>=0?o>k?g+=t.x:t.y<=0&&n>=j&&(r=!1):g+=t.x,t.y<=0?j>n&&(h-=t.y,j+=t.y):(h-=t.y,j+=t.y);0>g&&0>h?(b="sw",h=0,g=0):0>g?(b="nw",g=0):0>h&&(b="se",h=0);break;case"nw":if(s){if(t.y<=0&&(n>=j||m>=i)){r=!1;break}h-=t.y,j+=t.y,g=h*s,i+=t.X}else t.x<=0?i>m?(g-=t.x,i+=t.x):t.y<=0&&n>=j&&(r=!1):(g-=t.x,i+=t.x),t.y<=0?j>n&&(h-=t.y,j+=t.y):(h-=t.y,j+=t.y);0>g&&0>h?(b="se",h=0,g=0):0>g?(b="ne",g=0):0>h&&(b="sw",h=0);break;case"sw":if(s){if(t.x<=0&&(m>=i||l>=p)){r=!1;break}g-=t.x,i+=t.x,h=g/s}else t.x<=0?i>m?(g-=t.x,i+=t.x):t.y>=0&&l>=p&&(r=!1):(g-=t.x,i+=t.x),t.y>=0?p>l&&(h+=t.y):h+=t.y;0>g&&0>h?(b="ne",h=0,g=0):0>g?(b="se",g=0):0>h&&(b="nw",h=0);break;case"se":if(s){if(t.x>=0&&(k>=o||l>=p)){r=!1;break}g+=t.x,h=g/s}else t.x>=0?o>k?g+=t.x:t.y>=0&&l>=p&&(r=!1):g+=t.x,t.y>=0?p>l&&(h+=t.y):h+=t.y;0>g&&0>h?(b="nw",h=0,g=0):0>g?(b="sw",g=0):0>h&&(b="ne",h=0);break;case"move":d.left+=t.x,d.top+=t.y,this.renderCanvas(!0),r=!1;break;case"zoom":this.zoom(function(a,b,c,d){var e=U(a*a+b*b),f=U(c*c+d*d);return(f-e)/e}(X(this.startX-this.startX2),X(this.startY-this.startY2),X(this.endX-this.endX2),X(this.endY-this.endY2))),this.startX2=this.endX2,this.startY2=this.endY2,r=!1;break;case"crop":t.x&&t.y&&(a=this.$cropper.offset(),i=this.startX-a.left,j=this.startY-a.top,g=f.minWidth,h=f.minHeight,t.x>0?t.y>0?b="se":(b="ne",j-=h):t.y>0?(b="sw",i-=g):(b="nw",i-=g,j-=h),this.cropped||(this.cropped=!0,q(this.$cropBox.get(0),A)))}r&&(f.width=g,f.height=h,f.left=i,f.top=j,this.dragType=b,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},l(r.prototype,_),r.DEFAULTS={aspectRatio:NaN,autoCropArea:.8,crop:null,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,highlight:!0,background:!0,autoCrop:!0,dragCrop:!0,movable:!0,resizable:!0,rotatable:!0,zoomable:!0,touchDragZoom:!0,mouseWheelZoom:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null},r.setDefaults=function(a){l(r.DEFAULTS,a)},r.TEMPLATE=function(a,b){return b=b.split(","),a.replace(/\d+/g,function(a){return b[a]})}('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9" 3-2="move"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face" 3-2="all"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,drag,data,point,cropper,class,line,dashed,box"),r.other=a.fn.cropper,a.fn.cropper=function(b){var e,f=d(arguments,1);return this.each(function(){var c,d=a(this),g=d.data("cropper");g||d.data("cropper",g=new r(this,b)),"string"==typeof b&&"function"==typeof(c=g[b])&&(e=c.apply(g,f))}),c(e)?this:e},a.fn.cropper.Constructor=r,a.fn.cropper.setDefaults=r.setDefaults,a.fn.cropper.noConflict=function(){return a.fn.cropper=r.other,this}});